{{- $sections := where site.Pages "Kind" "section" -}}
{{- $sections = $sections | append site.Home -}}
{{- $list := slice -}}
{{- range $i, $e := $sections -}}
{{- $img := partial "funcs/get-bundle-image.html" . -}}
{{- $thumb := $img.Fill "640x400" -}}
{{- $section := cond (eq .Section "products") "products" "docs" -}}
{{- $baseSection := cond (eq $section "products") "" "docs > " -}}
{{- $objectID := (printf "%s%s" $baseSection (replace .SectionsPath "/" " > ")) -}}
{{-  $objectID =  $objectID | strings.TrimRight " >" -}}
{{- $list = $list | append  (dict "objectID" $objectID "section" $section "title" .Title "linkTitle" .LinkTitle "excerpt" ((.Params.description | markdownify )| default .Summary ) "thumbnail" $thumb.RelPermalink ) -}}
{{- end -}}
{{- $api := resources.Get "api/openapi.yaml" | openapi3.Unmarshal -}}
{{ range $i, $e := $api.Tags -}}
{{- $tag := .Name -}}
{{- $description := .Description }}
{{- $baseSection := $tag | anchorize -}}
{{- $objectID := printf "api > %s" $baseSection -}}
{{- $list = $list | append  (dict "objectID" $objectID "ordinal" (add $i 1) "section" "api" "title" $tag "linkTitle" $tag "excerpt" $description "thumbnail" "") -}}
{{ end }}
{{ $list | jsonify (dict "indent" "  ")  }}